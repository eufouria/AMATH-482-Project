clear all; close all; clc

reddy = ["VaiGiayNuaThoi.mp3" "Neu.mp3" "Gui.mp3" "ThiThoi.mp3"];
noo = ["TELDAKTN.mp3" "NhuPhutBanDau.mp3" "NhungKeMongMo.mp3" "ThuongMayCungLaNguoiDung.mp3"];
%bichphuong = ["BuiYeu.mp3" "BaoGioLayChong.mp3" "GuiAnhXaNho.mp3" "DiDuDuaDi.mp3"];
onlyc = ["YeuLaThaThu.mp3" "YeuDiDungSo.mp3" "GoiTenCoDon.mp3" "AnhDaSai.mp3"];

TestSet = [];
label = [];
for i = 1:4
    [y, Fs] = audioread(reddy(i));
    y = y(:,1); % stereo to mono
    [m,n]=size(y);
    dt=1/Fs;
    t=dt*(0:m-1);
    idx1 = (t>36) & (t<41);
    idx2 = (t>37) & (t<42);
    idx3 = (t>38) & (t<43);
    idx4 = (t>39) & (t<44);
    idx5 = (t>40) & (t<45);
    idx6 = (t>41) & (t<46);
    y1 = y(idx1);
    y1 = y1(1:220499, 1);
    y1 = abs(spectrogram(y1));
    y1 = y1(:);
    y1 = y1 - mean(y1);
    y2 = y(idx2);
    y2 = y2(1:220499, 1);
    y2 = abs(spectrogram(y2));
    y2 = y2(:);
    y2 = y2 - mean(y2);
    y3 = y(idx3);
    y3 = y3(1:220499, 1);
    y3 = abs(spectrogram(y3));
    y3 = y3(:);
    y3 = y3 - mean(y3);
    y4 = y(idx4);
    y4 = y4(1:220499, 1);
    y4 = abs(spectrogram(y4));
    y4 = y4(:);
    y4 = y4 - mean(y4);
    y5 = y(idx5);
    y5 = y5(1:220499, 1);
    y5 = abs(spectrogram(y5));
    y5 = y5(:);
    y5 = y5 - mean(y5);
    y6 = y(idx6);
    y6 = y6(1:220499, 1);
    y6 = abs(spectrogram(y6));
    y6 = y6(:);
    y6 = y6 - mean(y6);
    label = [label 0 0 0 0 0 0];
    TestSet = [TestSet y1 y2 y3 y4 y5 y6];
end
for i = 1:4
    [y, Fs] = audioread(noo(i));
    y = y(:,1); % stereo to mono
    [m,n]=size(y);
    dt=1/Fs;
    t=dt*(0:m-1);
    idx1 = (t>36) & (t<41);
    idx2 = (t>37) & (t<42);
    idx3 = (t>38) & (t<43);
    idx4 = (t>39) & (t<44);
    idx5 = (t>40) & (t<45);
    idx6 = (t>41) & (t<46);
    y1 = y(idx1);
    y1 = y1(1:220499, 1);
    y1 = abs(spectrogram(y1));
    y1 = y1(:);
    y1 = y1 - mean(y1);
    y2 = y(idx2);
    y2 = y2(1:220499, 1);
    y2 = abs(spectrogram(y2));
    y2 = y2(:);
    y2 = y2 - mean(y2);
    y3 = y(idx3);
    y3 = y3(1:220499, 1);
    y3 = abs(spectrogram(y3));
    y3 = y3(:);
    y3 = y3 - mean(y3);
    y4 = y(idx4);
    y4 = y4(1:220499, 1);
    y4 = abs(spectrogram(y4));
    y4 = y4(:);
    y4 = y4 - mean(y4);
    y5 = y(idx5);
    y5 = y5(1:220499, 1);
    y5 = abs(spectrogram(y5));
    y5 = y5(:);
    y5 = y5 - mean(y5);
    y6 = y(idx6);
    y6 = y6(1:220499, 1);
    y6 = abs(spectrogram(y6));
    y6 = y6(:);
    y6 = y6 - mean(y6);
    label = [label 1 1 1 1 1 1];
    TestSet = [TestSet y1 y2 y3 y4 y5 y6];
end

for i = 1:4
    [y, Fs] = audioread(onlyc(i));
    y = y(:,1); % stereo to mono
    [m,n]=size(y);
    dt=1/Fs;
    t=dt*(0:m-1);
    idx1 = (t>36) & (t<41);
    idx2 = (t>37) & (t<42);
    idx3 = (t>38) & (t<43);
    idx4 = (t>39) & (t<44);
    idx5 = (t>40) & (t<45);
    idx6 = (t>41) & (t<46);
    y1 = y(idx1);
    y1 = y1(1:220499, 1);
    y1 = abs(spectrogram(y1));
    y1 = y1(:);
    y1 = y1 - mean(y1);
    y2 = y(idx2);
    y2 = y2(1:220499, 1);
    y2 = abs(spectrogram(y2));
    y2 = y2(:);
    y2 = y2 - mean(y2);
    y3 = y(idx3);
    y3 = y3(1:220499, 1);
    y3 = abs(spectrogram(y3));
    y3 = y3(:);
    y3 = y3 - mean(y3);
    y4 = y(idx4);
    y4 = y4(1:220499, 1);
    y4 = abs(spectrogram(y4));
    y4 = y4(:);
    y4 = y4 - mean(y4);
    y5 = y(idx5);
    y5 = y5(1:220499, 1);
    y5 = abs(spectrogram(y5));
    y5 = y5(:);
    y5 = y5 - mean(y5);
    y6 = y(idx6);
    y6 = y6(1:220499, 1);
    y6 = abs(spectrogram(y6));
    y6 = y6(:);
    y6 = y6 - mean(y6);
    label = [label 2 2 2 2 2 2];
    TestSet = [TestSet y1 y2 y3 y4 y5 y6];
end
save('test_data', 'TestSet', 'label')



