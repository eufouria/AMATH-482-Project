clear all; close all; clc

reddy = ["VaiGiayNuaThoi.mp3" "Neu.mp3" "Gui.mp3" "ThiThoi.mp3"];
noo = ["TELDAKTN.mp3" "NhuPhutBanDau.mp3" "NhungKeMongMo.mp3" "ThuongMayCungLaNguoiDung.mp3"];
onlyc = ["YeuLaThaThu.mp3" "YeuDiDungSo.mp3" "GoiTenCoDon.mp3" "AnhDaSai.mp3"];

%bray = ["CaoOc20.mp3" "PhepMau.mp3" "ConTraiCung.mp3" "BSNL.mp3"];

data1 = [];
data2 = [];
data3 = [];

for i = 1:4
    [y, Fs] = audioread(reddy(i));
    y = y(:,1); % stereo to mono
    [m,n]=size(y);
    dt=1/Fs;
    t=dt*(0:m-1);
    idx1 = (t>30) & (t<35);
    idx2 = (t>31) & (t<36);
    idx3 = (t>32) & (t<37);
    idx4 = (t>33) & (t<38);
    idx5 = (t>34) & (t<39);
    idx6 = (t>35) & (t<40);
    y1 = y(idx1);
    y1 = y1(1:220499, 1);
    y1 = abs(spectrogram(y1));
    y1 = y1(:);
    y1 = y1 - mean(y1);
    y2 = y(idx2);
    y2 = y2(1:220499, 1);
    y2 = abs(spectrogram(y2));
    y2 = y2(:);
    y2 = y2 - mean(y2);
    y3 = y(idx3);
    y3 = y3(1:220499, 1);
    y3 = abs(spectrogram(y3));
    y3 = y3(:);
    y3 = y3 - mean(y3);
    y4 = y(idx4);
    y4 = y4(1:220499, 1);
    y4 = abs(spectrogram(y4));
    y4 = y4(:);
    y4 = y4 - mean(y4);
    y5 = y(idx5);
    y5 = y5(1:220499, 1);
    y5 = abs(spectrogram(y5));
    y5 = y5(:);
    y5 = y5 - mean(y5);
    y6 = y(idx6);
    y6 = y6(1:220499, 1);
    y6 = abs(spectrogram(y6));
    y6 = y6(:);
    y6 = y6 - mean(y6);
    data1 = [data1 y1 y2 y3 y4 y5 y6];
    
    [y, Fs] = audioread(noo(i));
    y = y(:,1); % stereo to mono
    [m,n]=size(y);
    dt=1/Fs;
    t=dt*(0:m-1);
    idx1 = (t>30) & (t<35);
    idx2 = (t>31) & (t<36);
    idx3 = (t>32) & (t<37);
    idx4 = (t>33) & (t<38);
    idx5 = (t>34) & (t<39);
    idx6 = (t>35) & (t<40);
    y1 = y(idx1);
    y1 = y1(1:220499, 1);
    y1 = abs(spectrogram(y1));
    y1 = y1(:);
    y1 = y1 - mean(y1);
    y2 = y(idx2);
    y2 = y2(1:220499, 1);
    y2 = abs(spectrogram(y2));
    y2 = y2(:);
    y2 = y2 - mean(y2);
    y3 = y(idx3);
    y3 = y3(1:220499, 1);
    y3 = abs(spectrogram(y3));
    y3 = y3(:);
    y3 = y3 - mean(y3);
    y4 = y(idx4);
    y4 = y4(1:220499, 1);
    y4 = abs(spectrogram(y4));
    y4 = y4(:);
    y4 = y4 - mean(y4);
    y5 = y(idx5);
    y5 = y5(1:220499, 1);
    y5 = abs(spectrogram(y5));
    y5 = y5(:);
    y5 = y5 - mean(y5);
    y6 = y(idx6);
    y6 = y6(1:220499, 1);
    y6 = abs(spectrogram(y6));
    y6 = y6(:);
    y6 = y6 - mean(y6);
    data2 = [data2 y1 y2 y3 y4 y5 y6];
    
    [y, Fs] = audioread(onlyc(i));
    y = y(:,1); % stereo to mono
    [m,n]=size(y);
    dt=1/Fs;
    t=dt*(0:m-1);
    idx1 = (t>30) & (t<35);
    idx2 = (t>31) & (t<36);
    idx3 = (t>32) & (t<37);
    idx4 = (t>33) & (t<38);
    idx5 = (t>34) & (t<39);
    idx6 = (t>35) & (t<40);
    y1 = y(idx1);
    y1 = y1(1:220499, 1);
    y1 = abs(spectrogram(y1));
    y1 = y1(:);
    y1 = y1 - mean(y1);
    y2 = y(idx2);
    y2 = y2(1:220499, 1);
    y2 = abs(spectrogram(y2));
    y2 = y2(:);
    y2 = y2 - mean(y2);
    y3 = y(idx3);
    y3 = y3(1:220499, 1);
    y3 = abs(spectrogram(y3));
    y3 = y3(:);
    y3 = y3 - mean(y3);
    y4 = y(idx4);
    y4 = y4(1:220499, 1);
    y4 = abs(spectrogram(y4));
    y4 = y4(:);
    y4 = y4 - mean(y4);
    y5 = y(idx5);
    y5 = y5(1:220499, 1);
    y5 = abs(spectrogram(y5));
    y5 = y5(:);
    y5 = y5 - mean(y5);
    y6 = y(idx6);
    y6 = y6(1:220499, 1);
    y6 = abs(spectrogram(y6));
    y6 = y6(:);
    y6 = y6 - mean(y6);
    data3 = [data3 y1 y2 y3 y4 y5 y6];
end
save('train_data', 'data1', 'data2', 'data3')